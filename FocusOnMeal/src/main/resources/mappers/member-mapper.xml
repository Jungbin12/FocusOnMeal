<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.fom.boot.domain.member.model.mapper.MemberMapper">


  	<select id="selectOneByLogin" parameterType="String" resultType="Member">
  		SELECT 
  		MEMBER_ID,
  		MEMBER_PW,
        MEMBER_NAME,
        MEMBER_NICKNAME,
        EMAIL,
        PHONE,
        GENDER,
        ENROLL_DATE,
        STATUS_YN,
        ADMIN_YN
  		FROM MEMBER
  		WHERE MEMBER_ID = #{memberId}
  	</select>
  	
    <!-- Spring Security용 쿼리 -->
    <select id="findByMemberId" parameterType="String"
            resultType="com.fom.boot.domain.member.model.vo.Member">
        SELECT
            MEMBER_ID,
            MEMBER_PW,
            MEMBER_NAME,
            MEMBER_NICKNAME,
            EMAIL,
            PHONE,
            GENDER,
            ENROLL_DATE,
            STATUS_YN,
            ADMIN_YN
        FROM MEMBER
        WHERE MEMBER_ID = #{memberId}
          AND STATUS_YN = 'Y' 
    </select>
    
    <!-- 회원가입 -->
    <insert id="insertMember" parameterType="Member">
        INSERT INTO MEMBER VALUES(
            #{memberId},
            #{memberPw},
            #{memberName},
            #{memberNickname},
            #{email},
            #{phone},
            #{gender},
            default,
            default,
            default
        )
    </insert>

    <!-- 관리자 권한 부여 -->
    <update id="updateAdminStatus" parameterType="string">
        UPDATE MEMBER
        SET ADMIN_YN = 'Y'
        WHERE MEMBER_ID = #{memberId}
    </update>

    <!-- 관리자 권한 부여 및 닉네임 변경 -->
    <update id="updateAdminNickname" parameterType="map">
        UPDATE MEMBER
        SET ADMIN_YN = 'Y',
            MEMBER_NICKNAME = #{newAdminNickname}
        WHERE MEMBER_ID = #{memberId}
    </update>

    <!-- 닉네임 변경 -->
    <update id="updateNickname" parameterType="map">
        UPDATE MEMBER
        SET MEMBER_NICKNAME = #{memberNickname}
        WHERE MEMBER_ID = #{memberId}
    </update>

    
  </mapper>
